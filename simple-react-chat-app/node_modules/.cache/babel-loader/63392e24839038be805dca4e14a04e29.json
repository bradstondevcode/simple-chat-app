{"ast":null,"code":"var _jsxFileName = \"/Users/bradston/Documents/Dev_Advocate/Blog Posts/Create Simple Realtime Chatroom with React, Node and Socket.io/simple-react-chat-app/src/pages/ChatRoom.js\";\nimport React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Row, Container } from 'react-bootstrap';\nimport { socket } from '../services/socket';\nimport CurrentUserText from '../components/CurrentUserText';\nimport OtherUserText from '../components/OtherUserText';\nimport ChatNotification from '../components/ChatNotification';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet styles = {\n  headerText: {\n    height: \"3vh\"\n  },\n  chatThread: {\n    backgroundColor: 'rgba(227, 227, 227, 0.2)',\n    flex: 0,\n    display: 'flex',\n    flexDirection: 'column',\n    height: \"75vh\",\n    overflowY: 'scroll',\n    width: '35vw',\n    alignSelf: 'center',\n    padding: 10\n  },\n  chatMessageInput: {\n    height: \"3vh\"\n  }\n};\nconst messagesEndRef = /*#__PURE__*/React.createRef();\n\nclass ChatRoom extends Component {\n  constructor(props) {\n    super(props);\n\n    this.scrollToBottom = () => {\n      this.messagesEndRef.current.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    };\n\n    this.state = {\n      currentUsername: \"User1\",\n      currentUserID: 1,\n      message: '',\n      chatRoomData: []\n    };\n  }\n\n  componentDidMount() {\n    // localStorage.removeItem('userID')\n    // localStorage.removeItem('username')\n    let userIDVal = localStorage.getItem('userID');\n    let usernameVal = localStorage.getItem('username');\n\n    if (!userIDVal) {\n      socket.on(\"SetUserData\", userData => {\n        localStorage.setItem('userID', userData.userID);\n        localStorage.setItem('username', userData.username);\n        console.log(userData);\n        this.setState({\n          currentUsername: userData.username,\n          currentUserID: userData.userID\n        });\n        socket.emit(\"UserEnteredRoom\", userData);\n      });\n      socket.emit(\"CreateUserData\");\n    } else {\n      console.log(usernameVal);\n      this.setState({\n        currentUsername: usernameVal,\n        currentUserID: userIDVal\n      });\n      socket.emit(\"UserEnteredRoom\", {\n        userID: userIDVal,\n        username: usernameVal\n      });\n    } //Retrieve game data (from GetGameData socket call)\n\n\n    socket.on(\"RetrieveChatRoomData\", chatRoomData => {\n      this.setState({\n        chatRoomData: chatRoomData\n      });\n    });\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillUnmount() {\n    // socket.emit(\"disconnect\", {username: this.state.currentUsername, userID: this.state.currentUserID})\n    socket.off(\"RetrieveChatRoomData\");\n    socket.off(\"SetUserData\");\n  }\n\n  setMessage(message) {\n    this.setState({\n      message: message\n    });\n  }\n\n  sendMessageData() {\n    var {\n      message,\n      currentUsername,\n      currentUserID\n    } = this.state;\n\n    if (message.length > 0) {\n      socket.emit(\"SendMessage\", {\n        message: message,\n        username: currentUsername,\n        userID: currentUserID,\n        timeStamp: null\n      });\n      this.setState({\n        message: ''\n      });\n    }\n  }\n\n  render() {\n    let {\n      chatRoomData,\n      currentUsername\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: styles.headerText,\n        children: \"Chat Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        style: styles.chatThread,\n        ref: this.messagesEndRef,\n        children: chatRoomData.map((messageData, index) => {\n          if (messageData.username == currentUsername) {\n            return /*#__PURE__*/_jsxDEV(CurrentUserText, {\n              username: messageData.username,\n              message: messageData.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 18\n            }, this);\n          } else if (messageData.username == '') {\n            return /*#__PURE__*/_jsxDEV(ChatNotification, {\n              username: messageData.username,\n              message: messageData.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 18\n            }, this);\n          } else {\n            return /*#__PURE__*/_jsxDEV(OtherUserText, {\n              username: messageData.username,\n              message: messageData.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 18\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"outlined-basic\",\n            label: \"Enter Message\",\n            variant: \"outlined\",\n            value: this.state.message,\n            onChange: event => this.setMessage(event.target.value),\n            onKeyPress: e => {\n              if (e.key === 'Enter') {\n                console.log('Enter key pressed');\n                this.sendMessageData(); // write your functionality here\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 10\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          style: styles.chatMessageInput,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            onClick: () => this.sendMessageData(),\n            children: \"Send Message\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 10\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 4\n    }, this);\n  }\n\n}\n\nexport default ChatRoom;","map":{"version":3,"sources":["/Users/bradston/Documents/Dev_Advocate/Blog Posts/Create Simple Realtime Chatroom with React, Node and Socket.io/simple-react-chat-app/src/pages/ChatRoom.js"],"names":["React","Component","Button","TextField","Row","Container","socket","CurrentUserText","OtherUserText","ChatNotification","styles","headerText","height","chatThread","backgroundColor","flex","display","flexDirection","overflowY","width","alignSelf","padding","chatMessageInput","messagesEndRef","createRef","ChatRoom","constructor","props","scrollToBottom","current","scrollIntoView","behavior","state","currentUsername","currentUserID","message","chatRoomData","componentDidMount","userIDVal","localStorage","getItem","usernameVal","on","userData","setItem","userID","username","console","log","setState","emit","componentDidUpdate","componentWillUnmount","off","setMessage","sendMessageData","length","timeStamp","render","map","messageData","index","event","target","value","e","key"],"mappings":"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","sourcesContent":["import React, {Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Row, Container } from 'react-bootstrap';\n\nimport {socket} from '../services/socket'\n\nimport CurrentUserText from '../components/CurrentUserText'\nimport OtherUserText from '../components/OtherUserText'\nimport ChatNotification from '../components/ChatNotification'\n\nlet styles = {\n\theaderText: {\n\t\theight: \"3vh\",\n\t},\n\tchatThread: {\n\t\tbackgroundColor: 'rgba(227, 227, 227, 0.2)',\n\t\tflex: 0,\n\t\tdisplay: 'flex',\n    \tflexDirection: 'column',\n    \theight: \"75vh\",\n    \toverflowY: 'scroll',\n    \twidth: '35vw',\n    \talignSelf: 'center',\n    \tpadding: 10,\n\t},\n\tchatMessageInput: {\n\t\theight: \"3vh\",\n\t}\n\n}\n\nconst messagesEndRef = React.createRef()\n\nclass ChatRoom extends Component {\n\n\tconstructor(props) {\n\t    super(props);\n\t    this.state = {\n\t    \tcurrentUsername: \"User1\",\n\t    \tcurrentUserID: 1,\n\t    \tmessage: '',\n\t    \tchatRoomData: [\n\t    \t]\n\t    };\n\n\t}\n\n\tcomponentDidMount(){\n\n\t\t// localStorage.removeItem('userID')\n\t\t// localStorage.removeItem('username')\n\n\t\tlet userIDVal = localStorage.getItem('userID')\n\t\tlet usernameVal = localStorage.getItem('username')\n\n\t\tif(!userIDVal){\n\n\t      socket.on(\"SetUserData\", userData => {\n\t        \n\t        localStorage.setItem('userID', userData.userID)\n\t        localStorage.setItem('username', userData.username)\n\t        console.log(userData)\n\n\t        this.setState({currentUsername: userData.username, currentUserID: userData.userID})\n\n\t        socket.emit(\"UserEnteredRoom\", userData)\n\t      });\n\n\t      socket.emit(\"CreateUserData\")\n\t    } \n\t    else {\n\t    \tconsole.log(usernameVal)\n\t    \tthis.setState({currentUsername: usernameVal, currentUserID: userIDVal})\n\t    \tsocket.emit(\"UserEnteredRoom\", {userID: userIDVal, username: usernameVal})\n\t    }\n\n\t    //Retrieve game data (from GetGameData socket call)\n\t    socket.on(\"RetrieveChatRoomData\", (chatRoomData) => {\n\t    \tthis.setState({chatRoomData: chatRoomData})\n\t    })\n\n\t    this.scrollToBottom()\n\n\t}\n\n\tcomponentDidUpdate () {\n\t\tthis.scrollToBottom()\n\t}\n\n\tcomponentWillUnmount(){\n\t\t// socket.emit(\"disconnect\", {username: this.state.currentUsername, userID: this.state.currentUserID})\n\t\tsocket.off(\"RetrieveChatRoomData\")\n\t\tsocket.off(\"SetUserData\")\n\t}\n\n\tsetMessage(message){\n\t\tthis.setState({message: message})\n\t}\n\n\tsendMessageData(){\n\t\tvar {message, currentUsername, currentUserID} = this.state\n\n\t\tif(message.length > 0){\n\n\t\t\tsocket.emit(\"SendMessage\", {message: message, username: currentUsername, userID: currentUserID, timeStamp: null})\n\n\t\t\tthis.setState({message: ''})\n\t\t}\n\t}\n\n\tscrollToBottom = () => {\n\t  this.messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n\t}\n\n\n\trender(){\n\n\t\tlet {chatRoomData, currentUsername} = this.state\n\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<h1 style={styles.headerText}>Chat Room</h1>\n\n\t\t\t\t<Container style={styles.chatThread} ref={this.messagesEndRef}>\n\t\t\t\t\t{chatRoomData.map( (messageData, index) => {\n\t\t\t\t\t\tif(messageData.username == currentUsername) {\n\t\t\t    \t\t\treturn <CurrentUserText username={messageData.username} message={messageData.message}/>\n\t\t\t    \t\t} else if (messageData.username == '') {\n\t\t\t    \t\t\treturn <ChatNotification username={messageData.username} message={messageData.message}/>\n\t\t\t    \t\t} else {\n\t\t\t    \t\t\treturn <OtherUserText username={messageData.username} message={messageData.message}/>\n\t\t\t    \t\t}\n\t\t\t\t\t}\n\t\t    \t\t\t\n\t\t    \t\t)}\n\n\t  \t\t\t\t\n\t    \t\t</Container>\n\n\t    \t\t<Container>\n\t\t    \t\t<Row>\n\t\t\t    \t\t<TextField \n\t\t\t    \t\t\tid=\"outlined-basic\" \n\t\t\t    \t\t\tlabel=\"Enter Message\" \n\t\t\t    \t\t\tvariant=\"outlined\"  \n\t\t\t    \t\t\tvalue={this.state.message} \n\t\t\t    \t\t\tonChange={(event) => this.setMessage(event.target.value)}\n\t\t\t    \t\t\tonKeyPress= {(e) => {\n\t\t\t\t\t            if (e.key === 'Enter') {\n\t\t\t\t\t              console.log('Enter key pressed');\n\t\t\t\t\t              this.sendMessageData()\n\t\t\t\t\t              // write your functionality here\n\t\t\t\t\t            }\n\t\t\t\t\t\t    }}\n\t\t\t    \t\t/>\n\t\t    \t\t</Row>\n\t\t    \t\t<Row style={styles.chatMessageInput}>\n\t\t\t    \t\t<Button variant=\"contained\" color=\"primary\" onClick={() => this.sendMessageData()}>\n\t\t\t\t\t \t\t Send Message\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\n\t\t\t</Container>\n\t\t);\n\t}\n}\n\nexport default ChatRoom;"]},"metadata":{},"sourceType":"module"}